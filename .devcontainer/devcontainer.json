{
	"name": "AI DEV EU 25 Observability Workshop",
	"image": "mcr.microsoft.com/devcontainers/base:jammy",
	"features": {
		// Docker-in-Docker support
		"ghcr.io/devcontainers/features/docker-in-docker:2": {},
		// Python + Poetry inside the devcontainer
		"ghcr.io/devcontainers/features/python:1": {
			"version": "3.11"
		},
		"ghcr.io/devcontainers-extra/features/poetry:latest": {}
	},
	// Use non-root dev user with docker group configured by the feature
	"remoteUser": "vscode",
	// "containerEnv": {
	// 	"POETRY_VIRTUALENVS_IN_PROJECT": "true"
	// },
	// Make local services reachable
	"forwardPorts": [
		8000,
		9090
	],
	"portsAttributes": {
		"8000": {
			"label": "FastAPI Backend"
		},
		"9090": {
			"label": "Prometheus"
		}
	},
	// VS Code ergonomics
	"customizations": {
		"vscode": {
			"extensions": [
				"ms-python.python",
				"ms-python.vscode-pylance",
				"ms-azuretools.vscode-docker",
				"ms-python.black-formatter",
				"ms-python.isort"
			],
			"settings": {
				"python.defaultInterpreterPath": "${workspaceFolder}/.venv/bin/python",
				"python.testing.pytestEnabled": true,
				"python.testing.pytestArgs": [
					"-q"
				],
				"python.formatting.provider": "black",
				"editor.formatOnSave": true
			}
		}
	},
	"onCreateCommand": "poetry install --no-interaction",
	"postCreateCommand": "curl -fsSL https://ollama.com/install.sh | sudo -E sh",
	"postStartCommand": "/bin/bash .devcontainer/startup.sh"
}